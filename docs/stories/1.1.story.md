# Story 1.1: Project Structure & Configuration Setup

## Status
Complete

## Story
**As a** developer,
**I want** a well-organized project structure with configuration files,
**so that** the codebase is maintainable and all components have clear locations.

## Acceptance Criteria
1. Directory structure created with folders: `mcp-servers/`, `scripts/`, `kb/`, `config/`, `docs/`
2. `package.json` configured with Node.js 20+, ES modules, and core dependencies
3. TypeScript configuration (`tsconfig.json`) created for MCP server development
4. `.gitignore` includes `node_modules/`, `.env`, `chroma_db/`, knowledge base raw files
5. `.env.example` template created with placeholders for GHL OAuth, Firecrawl API key
6. README.md created with project overview and setup instructions

## Tasks / Subtasks
- [x] Create complete directory structure (AC: 1)
  - [x] Create `mcp-servers/` directory for custom MCP server implementations
  - [x] Create `scripts/` directory for knowledge base pipeline scripts
  - [x] Create `kb/` directory with subdirectories: `ghl-docs/`, `youtube-transcripts/`, `best-practices/`, `snapshots-reference/`
  - [x] Create `config/` directory for configuration files
  - [x] Verify `docs/` directory exists with subdirectories: `prd/`, `architecture/`, `stories/`
- [x] Initialize Node.js project configuration (AC: 2)
  - [x] Create `package.json` with Node.js 20+ engine requirement
  - [x] Configure ES modules (`"type": "module"`)
  - [x] Add core dependencies: `@modelcontextprotocol/sdk`, `@xenova/transformers`, `zod`
  - [x] Add development dependencies: `typescript`, `@types/node`, `jest`, `eslint`, `prettier`
  - [x] Add npm scripts for KB pipeline: `scrape-docs`, `extract-yt`, `chunk-docs`, `build-kb`, `embed-content`
  - [x] Add npm scripts for development: `start-chroma`, `build-ghl-mcp`, `test-mcp`, `test-kb`
- [x] Create TypeScript configuration (AC: 3)
  - [x] Create `tsconfig.json` with ES2022 target
  - [x] Enable strict type checking
  - [x] Configure module resolution for Node.js
  - [x] Set output directory to `dist/`
  - [x] Include source maps for debugging
- [x] Create `.gitignore` file (AC: 4)
  - [x] Add `node_modules/` to ignore dependencies
  - [x] Add `.env` to protect credentials
  - [x] Add `chroma_db/` to ignore vector database files
  - [x] Add `kb/*/raw/` to ignore scraped content
  - [x] Add `kb/*/processed/` to ignore chunked content
  - [x] Add `dist/` to ignore compiled outputs
- [x] Create `.env.example` template (AC: 5)
  - [x] Add `GHL_CLIENT_ID=your_client_id_here` placeholder
  - [x] Add `GHL_CLIENT_SECRET=your_client_secret_here` placeholder
  - [x] Add `FIRECRAWL_API_KEY=your_firecrawl_key_here` placeholder
  - [x] Add `CHROMA_URL=http://localhost:8000` default value
  - [x] Add comments explaining where to obtain each credential
- [x] Create comprehensive README.md (AC: 6)
  - [x] Add project overview and purpose
  - [x] Document prerequisites: Node.js 20+, Docker Desktop, Claude Code
  - [x] Add installation instructions: clone, npm install, copy .env.example
  - [x] Document npm script usage for KB pipeline and development
  - [x] Add troubleshooting section for common setup issues
  - [x] Include links to PRD and architecture documentation

## Dev Notes

### Project Structure Overview
[Source: architecture/source-tree.md]

The complete directory structure follows this organization:
```
ghl-wiz/
├── .bmad-core/           # BMAD-METHOD framework (existing)
├── .claude/              # Claude Code configuration (existing)
├── docs/                 # Project documentation (existing)
├── kb/                   # Knowledge base content (TO CREATE)
│   ├── ghl-docs/
│   │   ├── raw/
│   │   └── processed/
│   ├── youtube-transcripts/
│   │   ├── by-creator/
│   │   ├── by-topic/
│   │   ├── index.json
│   │   └── failed.log
│   ├── best-practices/
│   ├── snapshots-reference/
│   ├── html-templates/
│   └── youtube-sources.json
├── mcp-servers/          # Custom MCP servers (TO CREATE)
│   └── ghl-api-server/
│       ├── src/
│       ├── dist/
│       ├── package.json
│       └── tsconfig.json
├── scripts/              # Knowledge base scripts (TO CREATE)
│   ├── scrape-ghl-docs.js
│   ├── extract-yt-transcripts.js
│   ├── chunk-documents.js
│   ├── embed-content.js
│   └── build-knowledge-base.js
├── config/               # Configuration files (TO CREATE)
│   ├── chroma-config.json
│   ├── mcp-servers.json
│   └── embeddings.json
├── tests/                # Test suite (TO CREATE)
├── .gitignore            # (TO CREATE)
├── package.json          # (TO CREATE)
└── README.md             # (TO CREATE)
```

### Technology Stack
[Source: architecture/3-tech-stack.md]

**Core Technologies:**
- **Runtime:** Node.js 20+ LTS (long-term support, excellent TypeScript/async support)
- **Languages:**
  - TypeScript 5.x (for MCP servers - type safety, better IDE support)
  - JavaScript ES2022 (for scripts and utilities)
- **Module System:** ES Modules (import/export)
- **MCP Framework:** FastMCP (TypeScript) and @modelcontextprotocol/sdk
- **Vector Database:** Chroma (lightweight, local-first)
- **Embedding Model:** all-MiniLM-L6-v2 (384 dims, 14.7ms/1K tokens)
- **Testing:** Jest (unit/integration tests)
- **Build Tools:** TypeScript Compiler (tsc), npm scripts

**Dependencies to Include:**
- `@modelcontextprotocol/sdk` - Official MCP SDK
- `@xenova/transformers` - Embedding generation
- `zod` - Schema validation for MCP tool inputs
- `typescript` - TypeScript compiler
- `@types/node` - Node.js type definitions
- `jest` - Testing framework
- `eslint` - Code quality
- `prettier` - Code formatting

### Coding Standards
[Source: architecture/coding-standards.md]

**Naming Conventions:**
- Classes: PascalCase (e.g., `OAuthManager`, `RateLimiter`)
- Functions/Methods: camelCase (e.g., `getAccessToken`, `createWorkflow`)
- Constants: UPPER_SNAKE_CASE (e.g., `MAX_RETRIES`, `DEFAULT_TIMEOUT`)
- Variables: camelCase (e.g., `contactId`, `workflowData`)

**Module System:**
- Use ES modules (`import`/`export`)
- Avoid CommonJS (`require`) in new code
- Use named exports for better refactoring

**Git Standards:**
- Commit message format: `<type>(<scope>): <subject>`
- Types: feat, fix, docs, style, refactor, test, chore
- Example: `feat(setup): initialize project structure`

### Environment Configuration
[Source: architecture/8-security-architecture.md]

**Required Environment Variables:**
- `GHL_CLIENT_ID` - GoHighLevel OAuth client ID (from GHL marketplace app)
- `GHL_CLIENT_SECRET` - GoHighLevel OAuth client secret
- `FIRECRAWL_API_KEY` - Firecrawl API key for documentation scraping
- `CHROMA_URL` - Chroma vector database URL (default: http://localhost:8000)

**Security Notes:**
- Never commit `.env` file to git
- Use `.env.example` as template without real credentials
- Store production credentials in secure environment variable management system

### NPM Scripts Configuration
[Source: architecture/source-tree.md]

**Knowledge Base Pipeline Scripts:**
```json
"scrape-docs": "node scripts/scrape-ghl-docs.js"
"extract-yt": "node scripts/extract-yt-transcripts.js"
"chunk-docs": "node scripts/chunk-documents.js"
"build-kb": "node scripts/build-knowledge-base.js"
"embed-content": "node scripts/embed-content.js"
```

**Development Scripts:**
```json
"start-chroma": "docker run -p 8000:8000 chromadb/chroma"
"build-ghl-mcp": "cd mcp-servers/ghl-api-server && npm run build"
"dev-ghl-mcp": "cd mcp-servers/ghl-api-server && npm run dev"
"test-mcp": "node tests/mcp-servers/test-ghl-api.js"
"test-kb": "node tests/knowledge-base/test-retrieval.js"
```

### Testing

**Test Standards:**
[Source: architecture/11-testing-strategy.md]

- Test file naming: `*.test.ts` or `*.spec.ts`
- One test file per source file
- Use descriptive test names: `describe('ClassName', () => { it('should do X when Y', ...) })`
- Aim for 80%+ code coverage
- Place integration tests in `tests/integration/`
- Use Jest as the testing framework

**Test Configuration:**
- Configure Jest for ES modules support
- Set up test coverage reporting
- Create test scripts in package.json

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-25 | 1.0 | Initial story creation | Bob (Scrum Master) |
| 2025-10-25 | 1.1 | Story implementation completed - all ACs met | James (Dev Agent) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Debug Log References
No debug log entries required for this story.

### Completion Notes List
- All directories verified or created (tests/ was missing, now created)
- package.json updated with Node.js 20+ engine requirement and all required dependencies
- tsconfig.json created with strict TypeScript configuration and ES2022 target
- .gitignore created with comprehensive exclusions for node_modules, .env, build outputs, and KB files
- .env.example already existed with excellent coverage; added CHROMA_URL variable as specified
- README.md created with comprehensive setup instructions, MCP server configuration (addressing QA feedback DOC-001), troubleshooting section, and links to docs
- All acceptance criteria met

### File List
- Modified: `package.json` (added engines, dependencies, devDependencies)
- Modified: `.env.example` (added CHROMA_URL variable)
- Created: `tsconfig.json`
- Created: `.gitignore`
- Created: `README.md`
- Created: `tests/` directory with subdirectories (mcp-servers/, knowledge-base/, integration/)

## QA Results

### Review Date: 2025-10-25

### Reviewed By: Quinn (Test Architect)

### Summary
Story 1.1 is well-structured with comprehensive acceptance criteria, detailed tasks, and complete technical context. All acceptance criteria are testable and properly mapped to implementation tasks. Only minor documentation enhancements suggested.

### Strengths
- ✅ Comprehensive task breakdown with clear subtasks
- ✅ All ACs are testable and well-defined
- ✅ Excellent technical context with source references to architecture docs
- ✅ Clear mapping between tasks and acceptance criteria (AC: 1-6)
- ✅ Proper separation of concerns (directories, configs, documentation)

### Findings
**Low Severity Issues (2):**

1. **DOC-001:** README.md should include MCP server configuration instructions
   - **Suggested Action:** Add section explaining .claude/settings.local.json setup

2. **TEST-001:** No explicit test task for directory creation verification
   - **Suggested Action:** Consider adding test script to verify directory structure

### Testability Score: 9/10
All ACs are verifiable through:
- File/directory existence checks
- package.json schema validation
- tsconfig.json compilation tests
- Environment variable template validation

### NFR Validation
- **Maintainability:** PASS - Clear structure, well-documented configs
- **Security:** PASS - Proper .gitignore, safe .env.example template
- **Reliability:** PASS (N/A for setup story)
- **Performance:** PASS (N/A for setup story)

### Recommendations
**Future Enhancements:**
- Consider adding validation script for project structure integrity
- Add .editorconfig for consistent formatting across IDEs

### Gate Status
Gate: **PASS** → [docs/qa/gates/1.1-project-structure-configuration-setup.yml](../qa/gates/1.1-project-structure-configuration-setup.yml)

**Decision:** Story is ready for development with no blocking issues.
