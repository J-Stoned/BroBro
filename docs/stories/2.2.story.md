# Story 2.2: YouTube Tutorial Curation & Extraction

## Status
Complete

## Story
**As a** knowledge curator,
**I want** transcripts from 50-100 curated GHL tutorial videos,
**so that** the knowledge base includes visual learning content and expert insights.

## Acceptance Criteria
1. `kb/youtube-sources.json` reviewed and populated with 50-100 videos from Robb Bailey, Shaun Clark, other verified experts
2. `scripts/extract-yt-transcripts.js` reads configuration file and processes all sources
3. Videos categorized by topic: workflows, funnels, SaaS mode, API, best practices
4. Transcripts extracted using YouTube Transcript Pro MCP
5. Fallback to YouTube Intelligence Suite for videos with unavailable transcripts
6. Metadata saved: video title, creator, URL, duration, publish date, category
7. Transcripts saved to `kb/youtube-transcripts/by-creator/` and `/by-topic/`
8. Index file (`kb/youtube-transcripts/index.json`) created with all metadata
9. Failed extractions logged to `kb/youtube-transcripts/failed.log` for manual review

## Tasks / Subtasks
- [ ] Curate YouTube video sources (AC: 1, 3)
  - [ ] Review and update `kb/youtube-sources.json` configuration
  - [ ] Research and add Robb Bailey's top workflow tutorials
  - [ ] Research and add Shaun Clark's top GHL tutorials
  - [ ] Research and add GHL Official channel videos
  - [ ] Research and add other verified GHL expert channels
  - [ ] Categorize videos by topic: workflows, funnels, saas, api, best-practices
  - [ ] Set appropriate priorities (high/medium/low)
  - [ ] Target 50-100 high-value videos total
  - [ ] Validate all channel IDs and video IDs
- [ ] Implement transcript extraction with YouTube Transcript Pro (AC: 2, 4)
  - [ ] Update `scripts/extract-yt-transcripts.js` to load youtube-sources.json
  - [ ] Implement creator-based extraction (iterate through creators)
  - [ ] Implement specific video extraction
  - [ ] Use YouTube Transcript Pro MCP for extraction
  - [ ] Extract full transcript text
  - [ ] Extract timed transcript with timestamps
  - [ ] Test extraction with sample videos
- [ ] Implement fallback mechanism (AC: 5)
  - [ ] Detect when YouTube Transcript Pro fails
  - [ ] Automatically retry with YouTube Intelligence Suite MCP
  - [ ] Log which server was used for each video
  - [ ] Handle videos without available transcripts
  - [ ] Test fallback with videos known to have issues
- [ ] Extract and save metadata (AC: 6)
  - [ ] Use get_video_info tool to extract metadata
  - [ ] Extract: video title, creator, URL, duration
  - [ ] Extract: publish date, view count (if available)
  - [ ] Add topic categorization from youtube-sources.json
  - [ ] Save metadata alongside transcripts
  - [ ] Create structured metadata JSON files
- [ ] Organize transcripts by creator and topic (AC: 7)
  - [ ] Save transcripts to `kb/youtube-transcripts/by-creator/{creator-name}/`
  - [ ] Create symlinks or copies to `kb/youtube-transcripts/by-topic/{topic}/`
  - [ ] Use sanitized filenames (remove special characters)
  - [ ] Include video ID in filename for uniqueness
  - [ ] Preserve both plain text and timestamped versions
- [ ] Create index file (AC: 8)
  - [ ] Generate `kb/youtube-transcripts/index.json` with all extracted videos
  - [ ] Include full metadata for each video
  - [ ] Include extraction timestamp and server used
  - [ ] Include file paths for transcripts
  - [ ] Make index searchable by topic, creator, keywords
- [ ] Implement error handling and logging (AC: 9)
  - [ ] Log failed extractions to `kb/youtube-transcripts/failed.log`
  - [ ] Include video ID, title, creator, error message
  - [ ] Distinguish between "no transcript available" vs extraction errors
  - [ ] Create summary report of successful vs failed extractions
  - [ ] Manual review critical failed videos
- [ ] Validate extraction quality and coverage
  - [ ] Verify 50-100 transcripts extracted successfully
  - [ ] Spot-check 10 random transcripts for quality
  - [ ] Verify topic distribution is balanced
  - [ ] Check timestamp accuracy in timed transcripts
  - [ ] Verify metadata completeness

## Dev Notes

### YouTube MCP Servers
[Source: architecture/3-tech-stack.md, architecture/4-system-architecture.md]

**Primary: YouTube Transcript Pro**
```yaml
youtube-transcript-pro:
  - get_transcript:
      parameters:
        - videoId: string
        - language: string (default: 'en')
      returns: { text: string, language: string }

  - get_timed_transcript:
      parameters:
        - videoId: string
      returns: array<{text, start, duration}>

  - get_video_info:
      parameters:
        - videoId: string
      returns: { title, creator, duration, publishDate }
```

**Fallback: YouTube Intelligence Suite**
- Use when Transcript Pro fails
- 8 tools available
- No API key required
- Smart format handling

### YouTube Sources Configuration
[Source: Story 1.6]

**File:** `kb/youtube-sources.json`

**Structure:**
- creators: Array of channel configurations
- videos: Array of specific video IDs
- playlists: Array of playlist configurations

**Each creator includes:**
- name, channelId, maxVideos, topics, priority, active

### Extraction Script Pattern

**Script:** `scripts/extract-yt-transcripts.js`

**Usage:**
```bash
node scripts/extract-yt-transcripts.js \
  --source-config kb/youtube-sources.json \
  --limit 100 \
  --output kb/youtube-transcripts
```

**Logic Flow:**
1. Load and parse youtube-sources.json
2. Sort by priority (high → medium → low)
3. For each creator:
   - Get recent videos (up to maxVideos)
   - Extract transcript with Transcript Pro
   - If fails, fallback to Intelligence Suite
   - Save transcript and metadata
4. For each specific video:
   - Extract regardless of creator limits
5. Generate index.json with all results

### Directory Structure

```
kb/youtube-transcripts/
├── by-creator/
│   ├── robb-bailey/
│   │   ├── video1-id-transcript.md
│   │   ├── video1-id-transcript.meta.json
│   │   ├── video1-id-timed.json
│   │   └── ...
│   ├── shaun-clark/
│   └── ghl-official/
├── by-topic/
│   ├── workflows/
│   ├── funnels/
│   ├── api/
│   ├── saas/
│   └── best-practices/
├── index.json
└── failed.log
```

### Metadata Schema

```json
{
  "videoId": "dQw4w9WgXcQ",
  "title": "GHL Workflow Masterclass",
  "creator": "Robb Bailey",
  "channelId": "UC...",
  "url": "https://youtube.com/watch?v=dQw4w9WgXcQ",
  "duration": 1234,
  "publishDate": "2024-05-15",
  "topics": ["workflows", "advanced"],
  "extractedAt": "2025-10-25T10:30:00Z",
  "extractionServer": "youtube-transcript-pro",
  "transcriptAvailable": true,
  "wordCount": 3456,
  "files": {
    "transcript": "by-creator/robb-bailey/video1-id-transcript.md",
    "timed": "by-creator/robb-bailey/video1-id-timed.json",
    "metadata": "by-creator/robb-bailey/video1-id-transcript.meta.json"
  }
}
```

### Index File Structure

```json
{
  "version": "1.0",
  "generatedAt": "2025-10-25T10:30:00Z",
  "totalVideos": 87,
  "successfulExtractions": 82,
  "failedExtractions": 5,
  "videos": [
    { /* metadata object */ },
    { /* metadata object */ }
  ],
  "topicDistribution": {
    "workflows": 25,
    "funnels": 18,
    "api": 12,
    "saas": 15,
    "best-practices": 17
  },
  "creatorDistribution": {
    "Robb Bailey": 30,
    "Shaun Clark": 28,
    "GHL Official": 24,
    "Others": 5
  }
}
```

### Expected Content Creators

**Robb Bailey:**
- Workflow automation expert
- Advanced GHL techniques
- Best practices
- Target: 25-30 videos

**Shaun Clark:**
- GHL expert
- SaaS mode specialist
- API integration
- Target: 25-30 videos

**GHL Official:**
- Platform updates
- Feature announcements
- Official tutorials
- Target: 20-25 videos

**Others:**
- Additional verified experts
- Target: 10-15 videos

### Testing

**Test Standards:**
[Source: architecture/11-testing-strategy.md]

- Test transcript extraction with valid video IDs
- Test fallback mechanism
- Test metadata extraction
- Test error handling for invalid IDs
- Test directory organization
- Verify index.json generation
- Spot-check transcript quality

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-25 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
_(To be filled by Dev Agent)_

### Debug Log References
_(To be filled by Dev Agent)_

### Completion Notes List
_(To be filled by Dev Agent)_

### File List
_(To be filled by Dev Agent)_

## QA Results

**Review Date:** 2025-10-25
**Reviewer:** Quinn (QA Agent)
**Gate Status:** PASS
**QA Gate File:** `docs/qa/gates/2.2-youtube-tutorial-curation.yml`

### Summary
Story 2.2 provides comprehensive YouTube transcript extraction with dual MCP fallback strategy. Good curation targets (50-100 videos from verified experts), robust error handling, and organized storage. Ready for development with minor recommendations around initial curation validation.

### Key Strengths
- Clear curation targets (Robb Bailey, Shaun Clark, GHL Official, 50-100 videos)
- Dual MCP strategy (YouTube Transcript Pro with Intelligence Suite fallback)
- Comprehensive metadata extraction and dual organization (by-creator and by-topic)
- Both plain text and timestamped transcript preservation
- Configuration-driven approach (youtube-sources.json)

### Findings
- **MEDIUM**: Dual dependency on two YouTube MCP servers - test both before starting
- **MEDIUM**: Symlinks vs copies not specified for topic organization - recommend copies for Windows compatibility
- **LOW**: youtube-sources.json needs validation before extraction (minimum 50 quality videos)
- **LOW**: Long-running operation (100 videos) - consider checkpoint/resume capability

### Recommendations
1. Verify both YouTube MCP servers are operational before starting extraction
2. Validate youtube-sources.json has minimum 50 high-quality videos with correct IDs
3. Test extraction with 5-10 sample videos before full batch processing
4. Use copies instead of symlinks for cross-platform support

**Testability Score:** 8/10
